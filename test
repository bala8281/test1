import pandas as pd
from google.cloud import storage

def read_csv_from_gcs(gcs_url, storage_client=None):
    if not gcs_url.startswith('gs://'):
        raise ValueError('GCS URL must start with "gs://".')

    bucket_name, path = gcs_url.split('/', 2)
    if storage_client is None:
        storage_client = storage.Client()
    bucket = storage_client.bucket(bucket_name)
    blob = bucket.blob(path)

    try:
        # Download the CSV file to a temporary file
        with tempfile.NamedTemporaryFile() as temp_file:
            blob.download_to_filename(temp_file.name)

            # Read the CSV file into a Pandas DataFrame
            df = pd.read_csv(temp_file.name)
    except Exception as e:
        raise Exception('Failed to read CSV file from GCS: {}'.format(e))

    return df

df = read_csv_from_gcs('gs://my-bucket/my-file.csv')
